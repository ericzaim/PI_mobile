{"ast":null,"code":"\"use strict\";var _slicedToArray=require(\"@babel/runtime/helpers/slicedToArray\");var _toConsumableArray=require(\"@babel/runtime/helpers/toConsumableArray\");Object.defineProperty(exports,\"__esModule\",{value:true});exports.defaultRouteInfo=void 0;exports.getRouteInfoFromState=getRouteInfoFromState;var constants_1=require(\"../constants\");var getPathFromState_forks_1=require(\"../fork/getPathFromState-forks\");exports.defaultRouteInfo={unstable_globalHref:'',searchParams:new URLSearchParams(),pathname:'/',params:{},segments:[],pathnameWithParams:'/',isIndex:false};function getRouteInfoFromState(state){if(!state)return exports.defaultRouteInfo;var route=state.routes[0];if(route.name!==constants_1.INTERNAL_SLOT_NAME){throw new Error(`Expected the first route to be ${constants_1.INTERNAL_SLOT_NAME}, but got ${route.name}`);}state=route.state;var segments=[];var params=Object.create(null);while(state){route=state.routes['index'in state&&state.index?state.index:0];Object.assign(params,route.params);var routeName=route.name;if(routeName.startsWith('/')){routeName=routeName.slice(1);}segments.push.apply(segments,_toConsumableArray(routeName.split('/')));state=route.state;}var routeParams=route.params;while(routeParams&&'screen'in routeParams){if(typeof routeParams.screen==='string'){var screen=routeParams.screen.startsWith('/')?routeParams.screen.slice(1):routeParams.screen;segments.push.apply(segments,_toConsumableArray(screen.split('/')));}if(typeof routeParams.params==='object'&&!Array.isArray(routeParams.params)){routeParams=routeParams.params;}else{routeParams=undefined;}}if(route.params&&'screen'in route.params&&route.params.screen==='string'){var _screen=route.params.screen.startsWith('/')?route.params.screen.slice(1):route.params.screen;segments.push.apply(segments,_toConsumableArray(_screen.split('/')));}if(segments[segments.length-1]==='index'){segments.pop();}delete params['screen'];delete params['params'];var pathParams=new Set();var pathname='/'+segments.filter(function(segment){return!(segment.startsWith('(')&&segment.endsWith(')'));}).flatMap(function(segment){if(segment==='+not-found'){var notFoundPath=params['not-found'];pathParams.add('not-found');if(typeof notFoundPath==='undefined'){return[];}else if(Array.isArray(notFoundPath)){return notFoundPath;}else{return[notFoundPath];}}else if(segment.startsWith('[...')&&segment.endsWith(']')){var paramName=segment.slice(4,-1);if(paramName.endsWith('?')){paramName=paramName.slice(0,-1);}var values=params[paramName];pathParams.add(paramName);return values||[];}else if(segment.startsWith('[')&&segment.endsWith(']')){var _paramName=segment.slice(1,-1);var value=params[_paramName];pathParams.add(_paramName);return value?[value]:[];}else{return[segment];}}).join('/');var searchParams=new URLSearchParams(Object.entries(params).flatMap(function(_ref){var _ref2=_slicedToArray(_ref,2),key=_ref2[0],value=_ref2[1];if(pathParams.has(key)){return[];}else if(Array.isArray(value)){return value.map(function(v){return[key,v];});}return[[key,value]];}));var hash;if(searchParams.has('#')){hash=searchParams.get('#')||undefined;searchParams.delete('#');}var searchParamString=searchParams.toString();var pathnameWithParams=searchParamString?pathname+'?'+searchParamString:pathname;pathnameWithParams=hash?pathnameWithParams+'#'+hash:pathnameWithParams;return{segments:segments,pathname:pathname,params:params,unstable_globalHref:(0,getPathFromState_forks_1.appendBaseUrl)(pathnameWithParams),searchParams:searchParams,pathnameWithParams:pathnameWithParams,isIndex:false};}","map":{"version":3,"names":["exports","getRouteInfoFromState","constants_1","require","getPathFromState_forks_1","defaultRouteInfo","unstable_globalHref","searchParams","URLSearchParams","pathname","params","segments","pathnameWithParams","isIndex","state","route","routes","name","INTERNAL_SLOT_NAME","Error","Object","create","index","assign","routeName","startsWith","slice","push","apply","_toConsumableArray","split","routeParams","screen","Array","isArray","undefined","length","pop","pathParams","Set","filter","segment","endsWith","flatMap","notFoundPath","add","paramName","values","value","join","entries","_ref","_ref2","_slicedToArray","key","has","map","v","hash","get","delete","searchParamString","toString","appendBaseUrl"],"sources":["C:\\Users\\ericz\\exprog\\PI_mobile\\node_modules\\expo-router\\src\\global-state\\routeInfo.ts"],"sourcesContent":["import type { NavigationState, PartialState } from '@react-navigation/native';\n\nimport type { FocusedRouteState } from './router-store';\nimport { INTERNAL_SLOT_NAME } from '../constants';\nimport { appendBaseUrl } from '../fork/getPathFromState-forks';\n\nexport type UrlObject = {\n  unstable_globalHref: string;\n  pathname: string;\n  readonly params: Record<string, string | string[]>;\n  searchParams: URLSearchParams;\n  segments: string[];\n  pathnameWithParams: string;\n  isIndex: boolean;\n};\n\nexport const defaultRouteInfo: UrlObject = {\n  unstable_globalHref: '',\n  searchParams: new URLSearchParams(),\n  pathname: '/',\n  params: {},\n  segments: [],\n  pathnameWithParams: '/',\n  // TODO: Remove this, it is not used anywhere\n  isIndex: false,\n};\n\n/**\n * A better typed version of `FocusedRouteState` that is easier to parse\n */\ntype StrictState = (FocusedRouteState | NavigationState | PartialState<NavigationState>) & {\n  routes: {\n    key?: string;\n    name: string;\n    params?: StrictFocusedRouteParams;\n    path?: string;\n    state?: StrictState;\n  }[];\n};\n\ntype StrictFocusedRouteParams =\n  | Record<string, string | string[]>\n  | {\n      screen?: string;\n      params?: StrictFocusedRouteParams;\n    };\n\nexport function getRouteInfoFromState(state?: StrictState): UrlObject {\n  if (!state) return defaultRouteInfo;\n\n  let route = state.routes[0];\n  if (route.name !== INTERNAL_SLOT_NAME) {\n    throw new Error(`Expected the first route to be ${INTERNAL_SLOT_NAME}, but got ${route.name}`);\n  }\n\n  state = route.state;\n\n  const segments: string[] = [];\n  const params: UrlObject['params'] = Object.create(null);\n\n  while (state) {\n    route = state.routes['index' in state && state.index ? state.index : 0];\n\n    Object.assign(params, route.params);\n\n    let routeName = route.name;\n    if (routeName.startsWith('/')) {\n      routeName = routeName.slice(1);\n    }\n\n    segments.push(...routeName.split('/'));\n    state = route.state;\n  }\n\n  /**\n   * If React Navigation didn't render the entire tree (e.g it was interrupted in a layout)\n   * then the state maybe incomplete. The reset of the path is in the params, instead of being a route\n   */\n  let routeParams: StrictFocusedRouteParams | undefined = route.params;\n  while (routeParams && 'screen' in routeParams) {\n    if (typeof routeParams.screen === 'string') {\n      const screen = routeParams.screen.startsWith('/')\n        ? routeParams.screen.slice(1)\n        : routeParams.screen;\n      segments.push(...screen.split('/'));\n    }\n\n    if (typeof routeParams.params === 'object' && !Array.isArray(routeParams.params)) {\n      routeParams = routeParams.params;\n    } else {\n      routeParams = undefined;\n    }\n  }\n\n  if (route.params && 'screen' in route.params && route.params.screen === 'string') {\n    const screen = route.params.screen.startsWith('/')\n      ? route.params.screen.slice(1)\n      : route.params.screen;\n    segments.push(...screen.split('/'));\n  }\n\n  if (segments[segments.length - 1] === 'index') {\n    segments.pop();\n  }\n\n  delete params['screen'];\n  delete params['params'];\n\n  const pathParams = new Set<string>();\n\n  const pathname =\n    '/' +\n    segments\n      .filter((segment) => {\n        return !(segment.startsWith('(') && segment.endsWith(')'));\n      })\n      .flatMap((segment) => {\n        if (segment === '+not-found') {\n          const notFoundPath = params['not-found'];\n\n          pathParams.add('not-found');\n\n          if (typeof notFoundPath === 'undefined') {\n            // Not founds are optional, do nothing if its not present\n            return [];\n          } else if (Array.isArray(notFoundPath)) {\n            return notFoundPath;\n          } else {\n            return [notFoundPath];\n          }\n        } else if (segment.startsWith('[...') && segment.endsWith(']')) {\n          let paramName = segment.slice(4, -1);\n\n          // Legacy for React Navigation optional params\n          if (paramName.endsWith('?')) {\n            paramName = paramName.slice(0, -1);\n          }\n\n          const values = params[paramName];\n          pathParams.add(paramName);\n\n          // Catchall params are optional\n          return values || [];\n        } else if (segment.startsWith('[') && segment.endsWith(']')) {\n          const paramName = segment.slice(1, -1);\n          const value = params[paramName];\n          pathParams.add(paramName);\n\n          // Optional params are optional\n          return value ? [value] : [];\n        } else {\n          return [segment];\n        }\n      })\n      .join('/');\n\n  const searchParams = new URLSearchParams(\n    Object.entries(params).flatMap(([key, value]) => {\n      // Search params should not include path params\n      if (pathParams.has(key)) {\n        return [];\n      } else if (Array.isArray(value)) {\n        return value.map((v) => [key, v]);\n      }\n      return [[key, value]];\n    })\n  );\n\n  let hash: string | undefined;\n  if (searchParams.has('#')) {\n    hash = searchParams.get('#') || undefined;\n    searchParams.delete('#');\n  }\n\n  // We cannot use searchParams.size because it is not included in the React Native polyfill\n  const searchParamString = searchParams.toString();\n  let pathnameWithParams = searchParamString ? pathname + '?' + searchParamString : pathname;\n  pathnameWithParams = hash ? pathnameWithParams + '#' + hash : pathnameWithParams;\n\n  return {\n    segments,\n    pathname,\n    params,\n    unstable_globalHref: appendBaseUrl(pathnameWithParams),\n    searchParams,\n    pathnameWithParams,\n    // TODO: Remove this, it is not used anywhere\n    isIndex: false,\n  };\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}